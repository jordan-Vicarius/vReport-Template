-- Daily Vulnerability Trends
-- Reusable query for vulnerability trends over time
SELECT 
    DATE(h_created_at) as event_date,
    event_type,
    COUNT(*) as event_count
FROM incident_view
WHERE h_created_at IS NOT NULL
    AND event_type IN ('DetectedActive', 'MitigatedVulnerability')
GROUP BY DATE(h_created_at), event_type
ORDER BY event_date DESC;
